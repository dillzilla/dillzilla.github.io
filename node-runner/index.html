<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node Runner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="hidden">
        <div class="loading-text">PROCESSING...</div>
    </div>

    <!-- Rules Screen -->
    <div id="rules-screen" class="hidden">
        <h2>// NODE RUNNER PROTOCOLS //</h2>
        <pre id="rules-content">
OBJECTIVE: Establish connection to the Mainframe by navigating sequential Nodes.
           Maximize Score by reaching deeper Nodes and completing objectives.

CORE MECHANICS:
- NODES: Each step in the connection route. Presents a challenge or opportunity.
- INTEGRITY: Connection stability (Starts at 5). Failure reduces Integrity. Reaching 0 terminates the run.
- DATA PACKETS: Resources used to overcome Node challenges (dice). Start with 15. Manage them carefully.
- SCORE: Increases with successful Node navigation. Bonus opportunities exist.
- HIGH SCORE: Highest score achieved is saved locally.

NODE CHALLENGES (Examples):
- Target Sum: Roll dice totaling OVER a target value (8-12) using 1-4 packets (Bonus for <= 2 packets).
- Target Under: Roll dice totaling UNDER a target value (5-8) using 1-5 packets (Bonus for >= 3 packets).
- Resonance Lock: Roll a specific number 1 or 2 times using 3-6 packets.
- Port Alignment: After rolling 1-8 packets, assign specific packets to specific ports. Assigned packet value must be >= port value. All ports must be successfully assigned.
- Bonus Nodes: Optional high-risk, high-reward scenarios (can be bypassed).

PUSH YOUR LUCK:
- Meet objectives using fewer/more packets than expected on certain nodes for bonus Score.
- Engage with Bonus Nodes or risk failure on tough standard Nodes. Choose wisely.

GLOSSARY:
- Runner: You, the user attempting connection.
- Mainframe: The target destination server.
- Node: A security checkpoint/router/data point.
- Integrity: Your connection's health/lives.
- Data Packets: Your dice/resource pool.
- Allocate/Commit: Choosing and using your packets.
- Bypass Route: Skipping an optional Bonus Node.
- Signature/Resonance/Parity/Port: Thematic terms for dice roll results/conditions.

> Connection terminated if Integrity drops to 0 or Data Packets are depleted for a required action.
> Good luck, Runner.
        </pre>
        <button id="back-to-main-button">Return to Interface</button>
    </div>

    <!-- Game Container -->
    <div id="game-container" class="">
        <div class="crt-overlay"></div>
        <header id="header">
            <span>NODE: <span id="node-number">0</span></span>
            <span>SCORE: <span id="score">0</span></span>
            <span>INTEGRITY: <span id="integrity-points">5</span></span> <!-- Updated Start -->
            <span>PACKETS: <span id="data-packets">15</span></span>
            <span>HI-SCORE: <span id="high-score">0</span></span>
        </header>

        <main id="main-display">
            <p id="node-description">
                <!-- Content generated by JS with typing effect -->
            </p>
            <p id="node-message" class="message-area">
                <!-- Content generated by JS with typing effect -->
            </p>
        </main>

        <div id="dice-area">
            <!-- Standard Dice Roll Display -->
            <p id="dice-results"></p>
            <!-- Port Alignment UI (Populated by JS) -->
            <div id="port-alignment-ui" class="hidden">
                 <div id="clickable-dice-area">Dice Available:</div>
                 <div id="clickable-ports-area">Target Ports:</div>
            </div>
        </div>

        <footer id="controls">
            <!-- Standard Dice Selection -->
            <div id="dice-selection-area" class="hidden">
                <label for="dice-select-input">Commit Packets (<span id="dice-range-label">1-?</span>): </label>
                <input type="number" id="dice-select-input" min="1" value="1">
                <button id="commit-button">Commit</button>
                <button id="skip-bonus-button" class="hidden">Bypass Route</button>
            </div>
             <!-- Port Alignment Confirmation -->
            <button id="confirm-alignment-button" class="hidden">Confirm Alignment</button>

            <!-- Standard Game Flow Buttons -->
            <button id="start-button">Initiate Sequence</button>
            <button id="rules-button">View Protocols</button>
            <button id="proceed-button" class="hidden">Advance to Next Node</button>
            <button id="play-again-button" class="hidden">Re-Initiate Connection?</button>
        </footer>
    </div>

    <!-- Simplified Audio Elements -->
    <audio id="audio-click" src="audio/click.mp3" preload="auto"></audio>
    <audio id="audio-loading" src="audio/loading.mp3" preload="auto"></audio>
    <audio id="audio-bgm-music" src="audio/bgm_music.mp3" preload="auto" loop></audio>
    <audio id="audio-bgm-endscreen" src="audio/bgm_endscreen_music.mp3" preload="auto" loop></audio>

    <script src="game.js"></script>
</body>
</html>